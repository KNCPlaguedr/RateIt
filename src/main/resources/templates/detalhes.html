
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Detalhes do Filme</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
 <link rel="stylesheet" th:href="@{/css/Style.css}" /> 
    <style>
        body.light {
            background-color: beige;
            color: black;
        }
        body.dark {
            background-color: rgba(105, 105, 105, 0.75);
            color: white;
        }
        .theme-toggle {
            padding: 10px 20px;
            cursor: pointer;
        }
        .btn{
            background-color:  rgb(193, 127, 202);
        }
    </style>
    
</head>
<body>
    
    <nav class="navbar bg-dark border-bottom border-body" data-bs-theme="dark">
  <div class="container-fluid">
      <button type="button" class="btn-close" aria-label="Close" onclick="window.location.href='/filmes'"></button>
    <a class="navbar-brand">Detalhes do Filme</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="/filmes">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/filmes/cadastrar">Cadastrar Novo Filme</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    
    <p>
    
  <form class="row g-3" th:action="@{/filmes/{id}/deletar(id=${filme.id})}" method="post" id="deleteFilme">
    <input type="hidden" name="_method" value="deletar">
    <button type="submit" id="dell" class="btn btn-outline-light">Excluir</button>
</form>
    
    <p>
    
    <form class="row g-3" th:action="@{/filmes/{id}/update(id=${filme.id})}" method="get" id="updateFilme">
    <input type="hidden" name="_method" value="update">
    <button type="submit" id="dell" class="btn btn-outline-light">Update</button>
</form>

    <p> 
        
    <div class="list-group">
  <a class="list-group-item list-group-item-action" aria-current="true">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1" th:text="${filme.titulo}"></h5>  
    </div>  
  </a>
        
  <a class="list-group-item list-group-item-action">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1">Sinopse</h5>
    </div>
      <p class="mb-1" th:text="${filme.sinopse}"></p>
  </a>
        
  <a class="list-group-item list-group-item-action">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1">Gênero</h5>
    </div>
    <p class="mb-1" th:text="${filme.genero}"></p>
  </a>
        
        <a class="list-group-item list-group-item-action">
    <div class="d-flex w-100 justify-content-between">
      <h5 class="mb-1">Ano de Lançamento</h5>
    </div>
    <p class="mb-1" th:text="${filme.anoLancamento}"></p>
  </a>
        
</div>
    
    <p>
    
    
    <form action="#" th:action="@{/filmes/{id}/analise(id=${filme.id})}" th:object="${analise}" method="post" id="formAnalise">
     
       
        
        
        <div class="col-md-12">
    <h4>Análise:</h4>
    <textarea id="analise" class="form-control" th:field="*{analise}" rows="5" placeholder="Digite a análise aqui..."></textarea>
  </div>
        
        <div class="col-md-6">
    <h4>Nota:</h4>
    <input type="number" class="form-control" id="nota" th:field="*{nota}" />
  </div>
      
    </p>
    <p>
        
        <button type="submit" class="btn btn-primary" id="btnAnalise">Adicionar Análise</button>

        
    </form>
    
    <p>
   
 <h3>Análises</h3>

<ul>
    <li th:each="analise : ${analises}">
        <form th:action="@{/filmes/{id}/delete(id=${analise.id})}" method="post">
            <p th:text="${analise.analise}"></p>
            <p><strong>Nota:</strong> <span th:text="${analise.nota}"></span></p>
            <button type="submit" class="btn btn-primary">Excluir Análise</button>
            <hr>
        </form>
    </li>
</ul>


 <script>
    // Função para obter o valor de um cookie
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
        }

        // Função para alternar o tema
        function toggleTheme() {
            const currentTheme = document.body.classList.contains('dark') ? 'dark' : 'light';
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.body.classList.remove(currentTheme);
            document.body.classList.add(newTheme);
            setCookie('theme', newTheme, 7);  // Salva o tema no cookie com validade de 7 dias
        }

        // Função para carregar o tema do cookie quando a página for aberta
        function loadTheme() {
            const savedTheme = getCookie('theme');
            if (savedTheme) {
                document.body.classList.add(savedTheme);
            } else {
                // Se não houver cookie, aplica o tema escuro por padrão
                document.body.classList.add('dark');
            }
        }

        // Chama a função para carregar o tema quando a página é carregada
        window.onload = loadTheme;
 </script>




   
   <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('btnAnalise').addEventListener('click', function(event) {
      if (!validarAnalise()) {
        event.preventDefault(); // Impede o envio do formulário se a validação falhar
      }
    });

    function validarAnalise() {
      // Validar Análise
      const analise = document.getElementById('analise').value;
      if (analise.trim() === '') {
        alert('A análise não pode estar vazia.');
        return false;
      }

      // Validar Nota
      const nota = document.getElementById('nota').value;
      if (nota === '' || nota < 0 || nota > 10) {
        alert('Insira uma nota válida entre 0 e 10.');
        return false;
      }
      
      return true;
    }
  });
</script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    
</body>
</html>
